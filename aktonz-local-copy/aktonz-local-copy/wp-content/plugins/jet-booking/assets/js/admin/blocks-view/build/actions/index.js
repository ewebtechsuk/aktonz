!function(){"use strict";function e(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=Array(n);t<n;t++)i[t]=e[t];return i}function n(n,t){return function(e){if(Array.isArray(e))return e}(n)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,o,l,a,r=[],s=!0,c=!1;try{if(l=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(i=l.call(t)).done)&&(r.push(i.value),r.length!==n);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw o}}return r}}(n,t)||function(n,t){if(n){if("string"==typeof n)return e(n,t);var i={}.toString.call(n).slice(8,-1);return"Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i?Array.from(n):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(n,t):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var t=window.ReactJSXRuntime,i=wp.components,o=i.SelectControl,l=i.TextControl,a=i.ToggleControl,r=i.BaseControl,s=i.Button,c=(i.Notice,wp.element),d=c.useState,u=c.useEffect,_=JetFBActions,f=_.addAction,b=_.getFormFieldsBlocks,p=JetFBComponents,g=p.ActionFieldsMap,m=p.WrapperRequiredControl,h=p.RepeaterWithState,j=p.ActionModal,w={type:"",label:"",format:"",field:"",link_label:""};f("apartment_booking",(function(e){var i=e.settings,c=e.source,_=e.label,f=e.help,p=e.onChangeSetting,k=n(d([]),2),x=k[0],v=k[1],C=n(d([]),2),y=C[0],S=C[1],F=n(d([]),2),A=F[0],B=F[1],P=n(d(!1),2),I=P[0],J=P[1],O=n(d(!1),2),R=O[0],T=O[1];function E(e){T(!0),jQuery.ajax({url:window.ajaxurl,type:"POST",dataType:"json",data:{action:"jet_booking_save_wc_details",post_id:c.apartment,nonce:c.nonce,details:e}}).done((function(n){T(!1),n.success?(JetBookingActionData.details=e,J(!1)):alert(n.data.message)})).fail((function(e,n,t){T(!1),alert(t)}))}return u((function(){var e={};c.columns.forEach((function(n){e[n]={label:n}}));var n={};c.wc_fields.forEach((function(e){n[e]={label:e}})),S(Object.entries(e)),B(Object.entries(n)),v(b([],"--"))}),[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{label:_("booking_apartment_field"),labelPosition:"side",value:i.booking_apartment_field,onChange:function(e){return p(e,"booking_apartment_field")},options:x}),(0,t.jsx)(o,{label:_("booking_dates_field"),labelPosition:"side",value:i.booking_dates_field,onChange:function(e){return p(e,"booking_dates_field")},options:x}),(0,t.jsx)(o,{label:_("booking_email_field"),labelPosition:"side",value:i.booking_email_field,onChange:function(e){return p(e,"booking_email_field")},options:x}),(0,t.jsx)(g,{label:_("db_columns_map"),fields:y,plainHelp:f("db_columns_map"),children:function(e){var n=e.fieldId,o=e.fieldData,a=e.index;return(0,t.jsx)(m,{field:[n,o],children:(0,t.jsx)(l,{value:i["db_columns_map_".concat(n)],onChange:function(e){return p(e,"db_columns_map_".concat(n))}},n+a)})}}),Boolean(c.wc_integration)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a,{label:_("disable_wc_integration"),help:f("disable_wc_integration"),checked:i.disable_wc_integration,onChange:function(e){p(e,"disable_wc_integration")}}),!Boolean(i.disable_wc_integration)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{label:_("booking_wc_price"),help:f("booking_wc_price"),labelPosition:"side",value:i.booking_wc_price,onChange:function(e){return p(e,"booking_wc_price")},options:x}),(0,t.jsx)(r,{label:_("wc_order_details"),help:f("wc_order_details"),children:(0,t.jsx)(s,{isSecondary:!0,onClick:function(){return J(!0)},children:"Set up"})}),(0,t.jsx)(g,{label:_("wc_fields_map"),fields:A,plainHelp:f("wc_fields_map"),children:function(e){var n=e.fieldId,l=e.fieldData,a=e.index;return(0,t.jsx)(m,{field:[n,l],children:(0,t.jsx)(o,{labelPosition:"side",value:i["wc_fields_map__".concat(n)],onChange:function(e){return p(e,"wc_fields_map__".concat(n))},options:x},n+a)})}}),I&&(0,t.jsx)(j,{title:"Set up WooCommerce order details",onRequestClose:function(){return J(!1)},classNames:["width-60"],style:{opacity:R?"0.5":"1"},updateBtnProps:{isBusy:R},children:function(e){var n=e.actionClick,i=e.onRequestClose;return(0,t.jsx)(h,{items:c.details,onSaveItems:E,newItem:w,onUnMount:function(){n||i()},isSaveAction:n,addNewButtonLabel:R?"Saving...":"Add new item +",children:function(e){var n=e.currentItem,i=e.changeCurrentItem;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{label:_("wc_details__type"),labelPosition:"side",value:n.type,onChange:function(e){return i({type:e})},options:c.details_types}),(0,t.jsx)(l,{label:_("wc_details__label"),value:n.label,onChange:function(e){return i({label:e})}}),["check-in","check-out"].includes(n.type)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l,{label:_("wc_details__format"),value:n.format,onChange:function(e){return i({format:e})}}),(0,t.jsx)("a",{href:"https://codex.wordpress.org/Formatting_Date_and_Time",target:"_blank",children:"Formatting docs"})]}),"field"===n.type&&(0,t.jsx)(o,{label:_("wc_details__field"),labelPosition:"side",value:n.field,onChange:function(e){return i({field:e})},options:x}),"add_to_calendar"===n.type&&(0,t.jsx)(l,{label:_("wc_details__link_label"),value:n.link_label,onChange:function(e){return i({link_label:e})}})]})}})}})]})]})]})}));var k=wp.components.SelectControl,x=wp.element,v=x.useEffect,C=x.useState,y=JetFBActions,S=y.addAction,F=y.Tools.withPlaceholder,A=JetFBComponents,B=A.ActionFieldsMap,P=A.WrapperRequiredControl,I=JetFBHooks.useFields;S("update_booking",(function(e){var i=e.help,o=e.label,l=e.settings,a=e.source,r=e.onChangeSetting,s=n(C([]),2),c=s[0],d=s[1],u=I({withInner:!1});return v((function(){var e={};a.bookingFields.forEach((function(n){e[n]={label:n}})),d(Object.entries(e))}),[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k,{label:o("booking_field_id"),labelPosition:"side",value:l.booking_field_id,options:F(u),onChange:function(e){return r(e,"booking_field_id")}}),(0,t.jsx)(k,{label:o("booking_field_dates"),labelPosition:"side",value:l.booking_field_dates,options:F(u),onChange:function(e){return r(e,"booking_field_dates")}}),(0,t.jsx)(B,{label:o("fields_map"),plainHelp:i("fields_map"),fields:c,children:function(e){var n=e.fieldId,o=e.fieldData;return(0,t.jsx)(P,{field:[n,o],children:(0,t.jsx)(k,{help:"apartment_id"===n?i("apartment_field"):"",value:l["booking_field_".concat(n)],options:F(u),onChange:function(e){return r(e,"booking_field_".concat(n))}},"booking_field_".concat(n))})}})]})}))}();