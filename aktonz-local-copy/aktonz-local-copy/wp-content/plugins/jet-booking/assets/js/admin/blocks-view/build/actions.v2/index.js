!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,n,o){return(n=function(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,r,l,a=[],c=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(a.push(o.value),a.length!==t);c=!0);}catch(e){s=!0,i=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var i=window.wp.element,r=window.wp.components,l=window.jfb.components,a=window.jfb.actions,c=window.wp.i18n,s=window.jfb.blocksToActions,d=window.wp.data,u=window.ReactJSXRuntime,f=JetFBComponents.RepeaterItemContext,b=[{value:"",label:(0,c.__)("Select type...","jet-booking")},{value:"booked-inst",label:(0,c.__)("Booked instance name","jet-booking")},{value:"check-in",label:(0,c.__)("Check in","jet-booking")},{value:"check-out",label:(0,c.__)("Check out","jet-booking")},{value:"unit",label:(0,c.__)("Booking unit","jet-booking")},{value:"field",label:(0,c.__)("Form field","jet-booking")},{value:"add_to_calendar",label:(0,c.__)("Add to Google calendar link","jet-booking")}],g=function(e){var t=e.formFields,n=(0,i.useContext)(f),o=n.currentItem,s=n.changeCurrentItem;return(0,u.jsxs)(r.Flex,{direction:"column",children:[(0,u.jsx)(a.ValidatedSelectControl,{label:(0,c.__)("Type","jet-booking"),value:o.type,onChange:function(e){return s({type:e})},options:b,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(a.ValidatedTextControl,{label:(0,c.__)("Label","jet-booking"),value:o.label,onChange:function(e){return s({label:e})},__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),["check-in","check-out"].includes(o.type)&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(l.RowControl,{children:function(e){var t=e.id;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.Label,{htmlFor:t,children:(0,c.__)("Date format","jet-booking")}),(0,u.jsxs)(l.RowControlEnd,{children:[(0,u.jsx)(r.TextControl,{id:t,value:o.format,onChange:function(e){return s({format:e})},__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,u.jsx)(l.Help,{children:(0,u.jsx)(r.ExternalLink,{href:"https://codex.wordpress.org/Formatting_Date_and_Time",children:(0,c.__)("Formatting docs","jet-booking")})})]})]})}})]}),"field"===o.type&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(a.ValidatedSelectControl,{label:(0,c.__)("Select form field","jet-booking"),value:o.field,onChange:function(e){return s({field:e})},options:t,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})]}),"add_to_calendar"===o.type&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(a.ValidatedTextControl,{label:(0,c.__)("Link text","jet-booking"),value:o.link_label,onChange:function(e){return s({link_label:e})},__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})]})]})},_=JetFBComponents,p=_.Repeater,j=_.RepeaterAddNew,m=_.RepeaterState,h=function(e){var t=e.setIsShow,n=o((0,i.useState)(!1),2),a=n[0],f=n[1],b=o((0,i.useState)((function(){return JetBookingActionData.details})),2),_=b[0],h=b[1],k=(0,s.useFields)({withInner:!1,placeholder:"--"}),x=(0,d.useSelect)((function(e){return e("core/editor").getEditedPostAttribute("id")}),[]);return(0,u.jsxs)(r.Modal,{size:"large",title:(0,c.__)("Set up WooCommerce order details","jet-booking"),onRequestClose:function(){return t(!1)},className:l.ModalFooterStyle,children:[(0,u.jsxs)(m,{state:function(e){h(e(_))},children:[(0,u.jsx)(p,{items:_,children:(0,u.jsx)(g,{formFields:k})}),(0,u.jsx)(j,{children:(0,c.__)("Add New Item","jet-booking")})]}),(0,u.jsxs)(l.StickyModalActions,{children:[(0,u.jsx)(r.Button,{isPrimary:!0,onClick:function(){f(!0),jQuery.ajax({url:window.ajaxurl,type:"POST",dataType:"json",data:{action:"jet_booking_save_wc_details",post_id:x,nonce:JetBookingActionData.nonce,details:_}}).done((function(e){e.success?(JetBookingActionData.details=_,t(!1)):alert(e.data.message)})).fail((function(e,t,n){alert(n)})).always((function(){f(!1)}))},disabled:a,isBusy:a,children:(0,c.__)("Update","jet-booking")}),(0,u.jsx)(r.Button,{isSecondary:!0,disabled:a,onClick:function(){return t(!1)},children:(0,c.__)("Cancel","jet-booking")})]})]})},k=function(e){var n=e.settings,o=e.onChangeSettingObj,i=(0,s.useFields)({withInner:!1,placeholder:"--"});return(0,u.jsxs)(l.RowControl,{createId:!1,children:[(0,u.jsx)(l.Label,{children:(0,c.__)("WooCommerce checkout fields map","jet-booking")}),(0,u.jsxs)(l.RowControlEnd,{gap:4,children:[(0,u.jsx)(l.Help,{children:(0,c.__)("Connect WooCommerce checkout fields to appropriate form fields. This allows you to pre-fill WooCommerce checkout fields after redirect to checkout.","jet-booking")}),JetBookingActionData.wc_fields.map((function(e){return(0,u.jsx)(a.FieldsMapField,{tag:e,label:e,formFields:i,value:n["wc_fields_map__".concat(e)],onChange:function(n){return o(t({},"wc_fields_map__".concat(e),n))}},e)}))]})]})},x=function(e){var n=e.settings,o=e.onChangeSettingObj,i=(0,s.useFields)({withInner:!1,placeholder:"--"});return(0,u.jsxs)(l.RowControl,{createId:!1,children:[(0,u.jsx)(l.Label,{children:(0,c.__)("DB columns map","jet-booking")}),(0,u.jsxs)(l.RowControlEnd,{gap:4,children:[(0,u.jsx)(l.Help,{children:(0,c.__)("Set up connection between form fields and additional database table columns. This allows you to save entered field data in the corresponding DB column.","jet-booking")}),JetBookingActionData.columns.map((function(e){return(0,u.jsx)(a.FieldsMapField,{tag:e,label:e,formFields:i,value:n["db_columns_map_".concat(e)],onChange:function(n){return o(t({},"db_columns_map_".concat(e),n))}},e)}))]})]})};function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?w(Object(o),!0).forEach((function(n){t(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):w(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var v=window.wp.primitives,C=(0,u.jsx)(v.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(v.Path,{d:"M12 4L4 7.9V20h16V7.9L12 4zm6.5 14.5H14V13h-4v5.5H5.5V8.8L12 5.7l6.5 3.1v9.7z"})}),S={type:"apartment_booking",label:(0,c.__)("Apartment Booking","jet-booking"),edit:function(e){var t,n=e.settings,d=e.onChangeSettingObj,f=(0,s.useFields)({withInner:!1,placeholder:"--"}),b=o((0,i.useState)(!1),2),g=b[0],_=b[1];return(0,u.jsxs)(r.Flex,{direction:"column",children:[(0,u.jsx)(a.ValidatedSelectControl,{label:(0,c.__)("Apartment ID field","jet-booking"),value:n.booking_apartment_field,onChange:function(e){return d({booking_apartment_field:e})},options:f,isErrorSupported:function(e){return"booking_apartment_field"===e.property},required:!0}),(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(a.ValidatedSelectControl,{label:(0,c.__)("Check-in/out date field","jet-booking"),value:n.booking_dates_field,onChange:function(e){return d({booking_dates_field:e})},options:f,isErrorSupported:function(e){return"booking_dates_field"===e.property},required:!0}),(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(a.ValidatedSelectControl,{label:(0,c.__)("E-mail field","jet-booking"),value:n.booking_email_field,options:f,onChange:function(e){return d({booking_email_field:e})}}),Boolean(null===(t=JetBookingActionData)||void 0===t||null===(t=t.columns)||void 0===t?void 0:t.length)&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(x,y({},e))]}),Boolean(JetBookingActionData.wc_integration)&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(r.ToggleControl,{className:l.ClearBaseControlStyle,label:(0,c.__)("Disable WooCommerce integration","jet-booking"),help:(0,c.__)("Check to disable WooCommerce integration and disconnect the booking system with WooCommerce checkout for current form.","jet-booking"),checked:n.disable_wc_integration,onChange:function(e){return d({disable_wc_integration:e})},__nextHasNoMarginBottom:!0}),!Boolean(n.disable_wc_integration)&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(a.ValidatedSelectControl,{label:(0,c.__)("WooCommerce Price field","jet-booking"),help:(0,c.__)("Select field to get total price from. If not selected price will be get from post meta value.","jet-booking"),value:n.booking_wc_price,onChange:function(e){return d({booking_wc_price:e})},options:f}),(0,u.jsx)(l.WideLine,{}),(0,u.jsxs)(l.RowControl,{createId:!1,children:[(0,u.jsx)(l.Label,{children:(0,c.__)("WooCommerce order details","jet-form-builder-woo-action")}),(0,u.jsxs)(l.RowControlEnd,{children:[(0,u.jsx)(r.FlexItem,{children:(0,u.jsx)(r.Button,{variant:"secondary",onClick:function(){return _(!0)},children:(0,c.__)("Set up","jet-booking")})}),(0,u.jsx)(l.Help,{children:(0,c.__)("Set up booking-related info you want to add to the WooCommerce orders and e-mails.","jet-booking")})]})]}),(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(k,y({},e))]})]}),g&&(0,u.jsx)(h,{setIsShow:_})]})},docHref:"https://crocoblock.com/knowledge-base/jetbooking/how-to-create-a-booking-form/",icon:C,validators:[function(e){var t=e.settings;return(null==t||!t.booking_apartment_field)&&{property:"booking_apartment_field"}},function(e){var t=e.settings;return(null==t||!t.booking_dates_field)&&{property:"booking_dates_field"}}]},O=function(e){var n=e.settings,o=e.onChangeSettingObj,r=e.source,d=(0,s.useFields)({withInner:!1,placeholder:"--"}),f=(0,i.useMemo)((function(){return r.bookingFields.map((function(e){return"string"==typeof e?{value:e,label:e}:e}))}),[]);return(0,u.jsxs)(l.RowControl,{createId:!1,children:[(0,u.jsx)(l.Label,{children:(0,c.__)("Fields map","jet-booking")}),(0,u.jsxs)(l.RowControlEnd,{gap:4,children:[(0,u.jsx)(l.Help,{children:(0,c.__)("Set booking properties to save appropriate form fields into.","jet-booking")}),f.map((function(e){return(0,u.jsx)(a.FieldsMapField,{help:"apartment_id"===e.value&&(0,c.__)("Note: changing the value in this field will not reinitialize the Check in/out field.","jet-booking"),tag:e.value,label:e.label,isRequired:e.required,formFields:d,value:n["booking_field_".concat(e.value)],onChange:function(n){return o(t({},"booking_field_".concat(e.value),n))}},e.value)}))]})]})};function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function B(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?F(Object(o),!0).forEach((function(n){t(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):F(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var D={type:"update_booking",label:(0,c.__)("Update Booking","jet-booking"),edit:function(e){var t=e.settings,n=e.onChangeSettingObj,o=(0,s.useFields)({withInner:!1,placeholder:"--"});return(0,u.jsxs)(r.Flex,{direction:"column",children:[(0,u.jsx)(a.ValidatedSelectControl,{label:(0,c.__)("Booking ID","jet-booking"),value:t.booking_field_id,onChange:function(e){return n({booking_field_id:e})},options:o,isErrorSupported:function(e){return"booking_field_id"===e.property},required:!0}),(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(a.ValidatedSelectControl,{label:(0,c.__)("Check-in/out date field","jet-booking"),value:t.booking_field_dates,onChange:function(e){return n({booking_field_dates:e})},options:o}),(0,u.jsx)(l.WideLine,{}),(0,u.jsx)(O,B({},e))]})},docHref:"https://crocoblock.com/knowledge-base/jetbooking/how-to-create-a-booking-form/",icon:C,validators:[function(e){var t=e.settings;return(null==t||!t.booking_field_id)&&{property:"booking_field_id"}},function(e){var t=e.settings;return(null==t||!t.booking_field_dates)&&{property:"booking_field_dates"}}]};(0,a.registerAction)(S),(0,a.registerAction)(D)}();