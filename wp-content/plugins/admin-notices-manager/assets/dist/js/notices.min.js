"use strict";jQuery(function(){var e='.hidden, .hide-if-js, .update-message, [aria-hidden="true"], .anm-display-notice';0<anm_i18n.settings.css_selector.length&&(e+=", "+anm_i18n.settings.css_selector),jQuery("#wpbody-content .wrap").find("div.updated, div.error, div.notice, #message").not(e).css({display:"none"})}),function(l,e){({container:null,counter_link:null,migration_delay:100,migration_interval:null,migration_start:0,migration_limit:5e3,popup_delay:50,popup_interval:null,popup_start:0,popup_limit:1e3,removal_interval:null,system_messages:[],init:function(){for(var e,n=this,t=this,i='<div id="anm-system-notices"></div><div id="anm-error-notices"></div><div id="anm-warning-notices"></div><div id="anm-success-notices"></div><div id="anm-information-notices"></div><div id="anm-misc-notices"></div>',a=("popup"==anm_i18n.settings.popup_style?(l("body").append('<div id="anm-container" style="display: none;">'+i+"</div>"),this.container=l("#anm-container")):(e=34,0<l(".woocommerce-layout__header").length&&(e+=l(".woocommerce-layout__header").height()),l("body").append('<div id="anm-container-slide-in" style="background-color: '+anm_i18n.settings.slide_in_background_colour+"; padding-top: "+e+'px;"><div id="anm-slide-in-content">'+i+"</div></div>"),this.container=l("#anm-slide-in-content")),this.counter_link=l("#wp-admin-bar-anm_notification_count"),this.initTriggers(),this.migration_start=(new Date).getTime(),this.migration_interval=setInterval(function(){n.transferNotices()},this.migration_delay),0),o=setInterval(function(){3===(a+=1)&&t.CheckAndStoreNotices(),4===a&&clearInterval(o)},150),s=anm_i18n.system_messages.length,r=0;r<s;r++){var c=anm_i18n.system_messages[r];this.system_messages.push(c.replace(/%[sdf]/g,""))}},getCurrentCounterValue:function(){var e=l(".anm-notification-counter span.count");return 0==e.length?0:parseInt(e.html(),10)},getNoticeType:function(e){e=l(e);return e.hasClass("notice-system")?"system":e.hasClass("notice-error")?"error":e.hasClass("notice-info")||e.hasClass("notice-information")?"information":e.hasClass("notice-warning")?"warning":e.hasClass("notice-success")||e.hasClass("updated")?"success":"misc"},checkMigrationInterval:function(){var e;(new Date).getTime()-this.migration_start>this.migration_limit&&(clearInterval(this.migration_interval),this.migration_interval=null,this.CheckAndStoreNotices(),0<(e=l(".anm-notices-wrapper")).children(this.getIgnoreSelector()).length&&(e.children().not(this.getIgnoreSelector()).remove(),e.show()))},getIgnoreSelector:function(){var e='.hidden, .hide-if-js, .update-message, [aria-hidden="true"], .anm-display-notice';return 0<anm_i18n.settings.css_selector.length&&(e+=", "+anm_i18n.settings.css_selector),e},getIgnoreParentSelector:function(){return"#loco-content"},transferNotices:function(){var o=this,s=l("#wpwrap ").find("div.updated, div.error, div.notice, #message").not(this.getIgnoreSelector()),a=(s.each(function(e,n){for(var t=o.system_messages.length,i=0;i<t;i++){var a=o.system_messages[i];0<n.innerHTML.indexOf(a)&&l(n).addClass("notice-system")}(l(n).parent(o.getIgnoreParentSelector()).length||l(n).parent().parent(o.getIgnoreParentSelector()).length)&&s.splice(e,1)}),0),r=this.container,e=(s.each(function(e,n){var t=o.getNoticeType(n),i=anm_i18n.settings["system"===t?"wordpress_system_admin_notices":t+"_level_notices"];"hide"===i?l(n).remove():"popup-only"===i||"misc"==t?(jQuery(n).css({display:"block"}),i=l(r).find("#anm-"+t+"-notices"),jQuery(n).find("p").length||jQuery(n).wrapInner("<p></p>"),l(n).detach().addClass("notice").appendTo(i),a++):jQuery(n).css({display:"block"}).addClass("leave-in-place")}),a);0<l(".anm-notification-counter").length&&(e+=this.getCurrentCounterValue()),this.updateCounterBubble(e),this.checkMigrationInterval()},updateCounterBubble:function(e){var n;e=this.container.find(".notice").length,0<l(".anm-notification-counter").length?l(".anm-notification-counter span.count").html(e):(n=anm_i18n.title,this.counter_link.find("a").html(n),e='<div class="anm-notification-counter wp-core-ui wp-ui-notification"><span aria-hidden="true" class="count">'+e+'</span><span class="screen-reader-text">'+e+" "+n+"</span></div>",this.counter_link.attr("data-popup-title",n),this.counter_link.find("a").append(e),this.counter_link.addClass("has-data"))},adjustModalHeight:function(){l("#TB_ajaxContent").css({width:"100%",height:l("#TB_window").height()-l("#TB_title").outerHeight()-22+"px",padding:"2px 0px 20px 0px"}),this.popup_interval&&(new Date).getTime()-this.popup_start>this.popup_limit&&(clearInterval(this.popup_interval),this.popup_interval=null)},checkNoticeRemoval:function(){var e;l("#TB_ajaxContent").height()?(e=l("#TB_ajaxContent").find(".notice").not(":hidden").length,this.getCurrentCounterValue()!==e&&this.updateCounterBubble(e)):this.removal_interval&&clearInterval(this.removal_interval)},CheckAndStoreNotices:function(){var n=jQuery(this.container).find(".notice"),t=[],i=this;n.each(function(e,n){jQuery(n).find(".anm-notice-timestamp").remove();n=n.outerHTML;t[e]=n}),jQuery.ajax({type:"POST",dataType:"json",url:anm_i18n.ajaxurl,data:{action:"anm_log_notices",_wpnonce:anm_i18n.nonce,notices:t},complete:function(e){i.appendTimeDate(n,e.responseJSON.data),l(".anm-notification-counter").addClass("display")}})},appendTimeDate:function(e,a){var o=this;e.each(function(e,n){var t,i;"do-not-display"==a[e]?(jQuery(n).remove(),t=o.getCurrentCounterValue(),o.updateCounterBubble(t-1)):"display-notice"==a[e][0]?(jQuery(n).addClass("anm-display-notice"),jQuery(n).insertAfter(".anm-notices-wrapper"),i='<div class="anm-notice-hide"><a href="#" data-hide-notice="'+a[e][1]+'">'+anm_i18n.hide_notice+"</a></div>",jQuery(n).find(".anm-notice-hide").length||jQuery(i).appendTo(n),o.updateCounterBubble(t-1)):(i='<div class="anm-notice-timestamp"><span class="anm-time">'+anm_i18n.date_time_preamble+a[e][1]+'</span><a href="#" data-hide-notice-forever="'+a[e][0]+'">'+anm_i18n.hide_notice_text+'</a> <a href="#" data-display-notice="'+a[e][0]+'">'+anm_i18n.display_notice+"</a></div>",jQuery(n).find(".anm-notice-timestamp").length||jQuery(i).appendTo(n))})},initTriggers:function(){var s=this;this.counter_link.click(function(){return s.popup_interval&&(clearInterval(s.popup_interval),s.popup_interval=null),0==s.getCurrentCounterValue()||("popup"==anm_i18n.settings.popup_style?tb_show(s.counter_link.attr("data-popup-title"),"#TB_inline?inlineId=anm-container"):l("#anm-container-slide-in").addClass("show"),s.popup_start=(new Date).getTime(),s.popup_interval=setInterval(function(){s.adjustModalHeight.call(s)},s.popup_delay),s.removal_interval&&clearInterval(s.removal_interval),s.removal_interval=setInterval(function(){s.checkNoticeRemoval.call(s)},s.popup_delay)),!1}),l(e).resize(function(){"popup"==anm_i18n.settings.popup_style&&s.adjustModalHeight.call(s)}),"slide-in"==anm_i18n.settings.popup_style&&l(document).on("click","body *",function(e){l(e.target).is("#anm-container-slide-in a")||l(e.target).is("#anm-container-slide-in")||l("#anm-container-slide-in").removeClass("show")}),jQuery(document).on("click","[data-hide-notice-forever]",function(e){e.preventDefault();var e=jQuery(this).attr("data-hide-notice-forever"),n=jQuery(this).closest(".notice"),t=l(".anm-notification-counter span.count").text(),i=s;jQuery.ajax({type:"POST",dataType:"json",url:anm_i18n.ajaxurl,data:{action:"anm_hide_notice_forever",_wpnonce:anm_i18n.nonce,notice_hash:e},complete:function(e){n.slideUp(300).delay(300).remove(),i.updateCounterBubble(t-1)}})}),jQuery(document).on("click","[data-display-notice]",function(e){e.preventDefault();var t=jQuery(this).attr("data-display-notice"),i=jQuery(this).closest(".notice"),a=l(".anm-notification-counter span.count").text(),o=s;jQuery.ajax({type:"POST",dataType:"json",url:anm_i18n.ajaxurl,data:{action:"anm_display_notice",_wpnonce:anm_i18n.nonce,notice_hash:t},complete:function(e){jQuery(i).find(".anm-notice-timestamp").remove(),jQuery(i).addClass("anm-display-notice");var n='<div class="anm-notice-hide"><a href="#" data-hide-notice="'+t+'">'+anm_i18n.hide_notice+"</a></div>",n=(jQuery(i).find(".anm-notice-hide").length||jQuery(n).appendTo(i),jQuery(i).insertAfter(".anm-notices-wrapper"),i.slideDown(),a-1);o.updateCounterBubble(n)}})}),jQuery(document).on("click","[data-hide-notice]",function(e){e.preventDefault();e=jQuery(this).attr("data-hide-notice");jQuery(this).closest(".notice"),l(".anm-notification-counter span.count").text();jQuery.ajax({type:"POST",dataType:"json",url:anm_i18n.ajaxurl,data:{action:"anm_hide_notice",_wpnonce:anm_i18n.nonce,notice_hash:e},complete:function(e){location.reload()}})})}}).init()}(jQuery,window);